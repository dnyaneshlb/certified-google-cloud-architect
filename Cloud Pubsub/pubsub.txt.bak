promises At least once delivery

HEavilly used inside google.

Supports offline consumers.

